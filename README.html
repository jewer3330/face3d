<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="uheadgame">uheadgame</h1>
<h2 id="can-u-image-your-head-in-unity-game">can u image your head in unity game?</h2>
<p>首先献丑了，这个就是我的头像和我的简历里面一模一样，不是很帅，满脸痘印，头发好久没理了。<br>
<img src="./1.png" alt="1"><br>
但是米哈游说宅男改变世界，于是我变成了下面这个模样，👇🏻<br>
<img src="./2.png" alt="2"><br>
怎么变的呢？有好几个步骤，不方便详说，只能说一下粗略的版本，留个纪念，如果你想做一个自己的产品，欢迎咨询，但是不要骚扰，谢谢。</p>
<p>以下是第一种方案，这种方案已经被公司申请实用性专利了，可以查到的。<br>
第一步是通过ios设备获取人脸的Mesh，这个有接口的，查一下苹果官方文档就可以了，
获取Mesh之后自然是缝合，可以看下图，主要要注意点对点缝合，加面，如果你不懂，可以问问身边的美术朋友。<br>
同时也要获得此时的照片，把UV算好。<br>
<img src="./13.png" alt="13"></p>
<p>上面的模型可以说迈出第一步了，但是还是很挫是不是？脸上的痘印啊，什么的都不行，如果是小姐姐拍了不得把自己吓死？这肯定不行的。所以我们还要正常的美白，磨皮，这里也是有相关文章可以参考的，比如表面模糊，等等，算法也是要优化了，基于O(1)的表面模糊也是要有的。<br>
可以看看10，11，12的图<br>
10<br>
<img src="./10.png" alt="10">
11<br>
<img src="./11.png" alt="11">
12<br>
<img src="./12.png" alt="12"></p>
<p>好的，经过上面的两步之后，还是有明显的问题的，美白力度过大，或产生泛白，就是说，自己本身的关键特征点也被美白掉了，比如眉毛，嘴巴等五官区域，注意，表面模糊化其实是一种保边过滤器，这里说的美白是指提亮颜色值得操作，可以通过HSL中L值来调整，那么怎么解决整体过白或者过黑的问题？
第三部就是人脸关键点的识别了，市面上的人脸识别的插件大都数都有108的识别，下面放一张特别喜感的图，就是把人脸关键点缝合成面之后的图形。</p>
<p>6
<img src="./6.png" alt="6">
没错，这个图也是本人了，是不是不太像？对了.<br>
这个图和拓扑结构和ios设备获得的mesh的uv的拓扑机构是一样的.<br>
也就是说照片和这个图存在转换关系，具体点就是，模型的1个顶点对应2套uv即可，ios设备的mesh是包含一组拓扑uv，另外一组则是照片的屏幕坐标了，准确的讲是视口坐标，这里可以构造一张lut用来查询。<br>
后面的步骤中美白时候，过滤一下这个Mask就可以了。<br>
当然边缘部分在构造这个图形的时候可以保留一个通道用来融合。<br>
1.换瞳孔也是要用到这张图的。（其中一种方案）<br>
2.给嘴唇上色也是可以用的。<br>
可以看一下下图的效果，虽然皮肤颜色拉爆了，但是眉毛嘴巴基本得以保留。<br>
男
<img src="./9.png" alt="9">
女
<img src="./5.png" alt="5"></p>
<p>当然拍照的时候不能保证用户拍不到头发，这个APP会提示，所以提示脏区也很重要，算法有兴趣的可以来咨询，效果如下<br>
<img src="./4.png" alt="4"></p>
<p>再来欣赏一下
<img src="./2.png" alt="2">
关于光线的部分也是要好好考虑的，这部分很难，可能机器学习是个思路。<br>
关于瞳色的部分，可以考虑用假眼球来实现，但是要注意前脸缝合眼眶处是否有漏洞。也可以考虑贴图替换，但是这个前脸的照片的贴图精度势必要提高，而这个就和ios设备厂商沟通了，因为图片本身就是720p的，眼睛部分占比非常小，不够精细。</p>
<p>还有一种方案在我的网盘里，就不方便公开了，包含后续骨骼捏脸的部分，这种方案应该更好。包含了大多数现在MMORPG手游的捏脸需求。</p>
<p>最后给大家看一下成品<br>
<img src="./xy3yg-nnyr0.gif" alt="gif"><br>
看到这里的一定是真爱了，请我喝杯咖啡☕️怎样？<br>
<img src="./WechatIMG17.jpeg" alt="wechat">
<img src="./WechatIMG16.jpeg" alt="alipay"></p>
<h1 id="uheadgame">uheadgame</h1>
<h2 id="translated-by-google">Translated by Google</h2>
<p>can u image your head in a unity game?</p>
<p>First of all, I'm showing my ugliness. This is my profile picture which is exactly the same as in my resume. It is not very handsome, with acne marks on my face, and my hair has been out of control for a long time.
<img src="./1.png" alt="1">
But Mihoyo the otaku to save the world, so I became like this one below, 👇🏻
<img src="./2.png" alt="2">
How did it change? There are several steps, it is not convenient to elaborate, I can only talk about a rough version, leave a commemorative, if you want to make a product of your own, welcome to consult, but do not harass, thank you.</p>
<p>The following is the first scheme. This scheme has been applied for a utility patent by the company and can be found.
The first step is to get the face mesh through the ios device. This one has an interface, just check the official Apple documentation.
After obtaining the Mesh, it is naturally stitched. You can see the picture below. The main thing to pay attention to is the point-to-point stitching and adding surface. If you don't understand, you can ask your art friends around you.
At the same time, get the photo at this time and calculate the UV.</p>
<p><img src="./13.png" alt="13"></p>
<p>The above model can be said to have taken the first step, but it is still very frustrating, isn't it? The acne marks on the face, nothing works, if it's the young lady who took a picture, can't you scare yourself to death? This will definitely not work. Therefore, we have to perform normal whitening and dermabrasion. There are also related articles for reference, such as surface blur, etc. The algorithm should also be optimized, and the surface blur based on O(1) is also required.
You can look at the graphs of 10, 11, and 12<br>
10
<img src="./10.png" alt="10">
11
<img src="./11.png" alt="11">
12
<img src="./12.png" alt="12"></p>
<p>Okay, after the above two steps, there are still obvious problems. The whitening power is too large, or whitening occurs, that is, the key features of oneself are also whitened off, such as eyebrows, mouth and other facial features. Note that the surface fuzzification is actually a kind of edge-preserving filter. The whitening mentioned here means that the brightening of the color is worth the operation. It can be adjusted by the L value in the HSL, so how to solve the overall problem of over-white or over-black?
The third part is the recognition of the key points of the face. Most of the face recognition plug-ins on the market have 108 recognitions. Below is a particularly happy picture, which is the figure after stitching the key points of the face into a surface. .</p>
<p><img src="./6.png" alt="6">
That's right, this picture is also my own, isn't it not very similar? correct.<br>
This diagram and topology are the same as the topology of the mesh uv obtained by the ios device.
In other words, there is a conversion relationship between the photo and this graph. The specific point is that one vertex of the model corresponds to two sets of uv. The mesh of the ios device contains a set of topological uv, and the other set is the screen coordinates of the photo, which is accurate It is the viewport coordinates. Here you can construct a lut for query.
When whitening in the following steps, just filter this Mask.
Of course, the edge part can reserve a channel for fusion when constructing this graphic.</p>
<ol>
<li>This picture is also used to change pupils. (One of the options)</li>
<li>It can also be used to color the lips.
You can take a look at the effect in the picture below. Although the skin color is burst, but the eyebrows and mouth are basically preserved.<br>
male
<img src="./9.png" alt="9">
Female
<img src="./5.png" alt="5"></li>
</ol>
<p>Of course, there is no guarantee that the user will not be able to take the hair when taking pictures. This APP will prompt, so the dirty area is also very important. If the algorithm is interested, you can come to consult. The effect is as follows
<img src="./4.png" alt="4"></p>
<p>Let's enjoy it again
<img src="./2.png" alt="2">
The part about light should also be considered carefully. This part is difficult. Perhaps machine learning is an idea.
Regarding the part of the pupil color, you can consider using fake eyeballs to achieve it, but pay attention to whether there are holes in the eye sockets of the front face. You can also consider texture replacement, but the texture accuracy of the front face photo is bound to be improved, and this is communicated with the ios device manufacturer, because the picture itself is 720p, and the proportion of the eyes is very small and not detailed enough.</p>
<p>There is another solution in my network disk, which is not convenient to disclose, including the part of the subsequent bone pinching face. This solution should be better. Contains most of the current MMORPG mobile game's face pinching needs.</p>
<p>Finally, I will show you the finished product
<img src="./xy3yg-nnyr0.gif" alt="gif"><br>
It must be true love to see here. How about a cup of coffee for me?
<img src="./WechatIMG17.jpeg" alt="wechat">
<img src="./WechatIMG16.jpeg" alt="alipay"></p>

</body>
</html>
