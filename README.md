# uheadgame
## can u image your head in unity game?  

é¦–å…ˆçŒ®ä¸‘äº†ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘çš„å¤´åƒå’Œæˆ‘çš„ç®€å†é‡Œé¢ä¸€æ¨¡ä¸€æ ·ï¼Œä¸æ˜¯å¾ˆå¸…ï¼Œæ»¡è„¸ç—˜å°ï¼Œå¤´å‘å¥½ä¹…æ²¡ç†äº†ã€‚  
![1](/1.png)   
ä½†æ˜¯ç±³å“ˆæ¸¸è¯´å®…ç”·æ”¹å˜ä¸–ç•Œï¼Œäºæ˜¯æˆ‘å˜æˆäº†ä¸‹é¢è¿™ä¸ªæ¨¡æ ·ï¼ŒğŸ‘‡ğŸ»  
![2](/2.png)  
æ€ä¹ˆå˜çš„å‘¢ï¼Ÿæœ‰å¥½å‡ ä¸ªæ­¥éª¤ï¼Œä¸æ–¹ä¾¿è¯¦è¯´ï¼Œåªèƒ½è¯´ä¸€ä¸‹ç²—ç•¥çš„ç‰ˆæœ¬ï¼Œç•™ä¸ªçºªå¿µï¼Œå¦‚æœä½ æƒ³åšä¸€ä¸ªè‡ªå·±çš„äº§å“ï¼Œæ¬¢è¿å’¨è¯¢ï¼Œä½†æ˜¯ä¸è¦éªšæ‰°ï¼Œè°¢è°¢ã€‚  

ä»¥ä¸‹æ˜¯ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œè¿™ç§æ–¹æ¡ˆå·²ç»è¢«å…¬å¸ç”³è¯·å®ç”¨æ€§ä¸“åˆ©äº†ï¼Œå¯ä»¥æŸ¥åˆ°çš„ã€‚  
ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡iosè®¾å¤‡è·å–äººè„¸çš„Meshï¼Œè¿™ä¸ªæœ‰æ¥å£çš„ï¼ŒæŸ¥ä¸€ä¸‹è‹¹æœå®˜æ–¹æ–‡æ¡£å°±å¯ä»¥äº†ï¼Œ
è·å–Meshä¹‹åè‡ªç„¶æ˜¯ç¼åˆï¼Œå¯ä»¥çœ‹ä¸‹å›¾ï¼Œä¸»è¦è¦æ³¨æ„ç‚¹å¯¹ç‚¹ç¼åˆï¼ŒåŠ é¢ï¼Œå¦‚æœä½ ä¸æ‡‚ï¼Œå¯ä»¥é—®é—®èº«è¾¹çš„ç¾æœ¯æœ‹å‹ã€‚  
åŒæ—¶ä¹Ÿè¦è·å¾—æ­¤æ—¶çš„ç…§ç‰‡ï¼ŒæŠŠUVç®—å¥½ã€‚    
![13](/13.png)

ä¸Šé¢çš„æ¨¡å‹å¯ä»¥è¯´è¿ˆå‡ºç¬¬ä¸€æ­¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¾ˆæŒ«æ˜¯ä¸æ˜¯ï¼Ÿè„¸ä¸Šçš„ç—˜å°å•Šï¼Œä»€ä¹ˆçš„éƒ½ä¸è¡Œï¼Œå¦‚æœæ˜¯å°å§å§æ‹äº†ä¸å¾—æŠŠè‡ªå·±å“æ­»ï¼Ÿè¿™è‚¯å®šä¸è¡Œçš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜è¦æ­£å¸¸çš„ç¾ç™½ï¼Œç£¨çš®ï¼Œè¿™é‡Œä¹Ÿæ˜¯æœ‰ç›¸å…³æ–‡ç« å¯ä»¥å‚è€ƒçš„ï¼Œæ¯”å¦‚è¡¨é¢æ¨¡ç³Šï¼Œç­‰ç­‰ï¼Œç®—æ³•ä¹Ÿæ˜¯è¦ä¼˜åŒ–äº†ï¼ŒåŸºäºO(1)çš„è¡¨é¢æ¨¡ç³Šä¹Ÿæ˜¯è¦æœ‰çš„ã€‚  
å¯ä»¥çœ‹çœ‹10ï¼Œ11ï¼Œ12çš„å›¾  
10  
![10](/10.png)
11  
![11](/11.png)
12  
![12](/12.png)

å¥½çš„ï¼Œç»è¿‡ä¸Šé¢çš„ä¸¤æ­¥ä¹‹åï¼Œè¿˜æ˜¯æœ‰æ˜æ˜¾çš„é—®é¢˜çš„ï¼Œç¾ç™½åŠ›åº¦è¿‡å¤§ï¼Œæˆ–äº§ç”Ÿæ³›ç™½ï¼Œå°±æ˜¯è¯´ï¼Œè‡ªå·±æœ¬èº«çš„å…³é”®ç‰¹å¾ç‚¹ä¹Ÿè¢«ç¾ç™½æ‰äº†ï¼Œæ¯”å¦‚çœ‰æ¯›ï¼Œå˜´å·´ç­‰äº”å®˜åŒºåŸŸï¼Œæ³¨æ„ï¼Œè¡¨é¢æ¨¡ç³ŠåŒ–å…¶å®æ˜¯ä¸€ç§ä¿è¾¹è¿‡æ»¤å™¨ï¼Œè¿™é‡Œè¯´çš„ç¾ç™½æ˜¯æŒ‡æäº®é¢œè‰²å€¼å¾—æ“ä½œï¼Œå¯ä»¥é€šè¿‡HSLä¸­Lå€¼æ¥è°ƒæ•´ï¼Œé‚£ä¹ˆæ€ä¹ˆè§£å†³æ•´ä½“è¿‡ç™½æˆ–è€…è¿‡é»‘çš„é—®é¢˜ï¼Ÿ
ç¬¬ä¸‰éƒ¨å°±æ˜¯äººè„¸å…³é”®ç‚¹çš„è¯†åˆ«äº†ï¼Œå¸‚é¢ä¸Šçš„äººè„¸è¯†åˆ«çš„æ’ä»¶å¤§éƒ½æ•°éƒ½æœ‰108çš„è¯†åˆ«ï¼Œä¸‹é¢æ”¾ä¸€å¼ ç‰¹åˆ«å–œæ„Ÿçš„å›¾ï¼Œå°±æ˜¯æŠŠäººè„¸å…³é”®ç‚¹ç¼åˆæˆé¢ä¹‹åçš„å›¾å½¢ã€‚

6
![6](/6.png)
æ²¡é”™ï¼Œè¿™ä¸ªå›¾ä¹Ÿæ˜¯æœ¬äººäº†ï¼Œæ˜¯ä¸æ˜¯ä¸å¤ªåƒï¼Ÿå¯¹äº†.  
è¿™ä¸ªå›¾å’Œæ‹“æ‰‘ç»“æ„å’Œiosè®¾å¤‡è·å¾—çš„meshçš„uvçš„æ‹“æ‰‘æœºæ„æ˜¯ä¸€æ ·çš„.  
ä¹Ÿå°±æ˜¯è¯´ç…§ç‰‡å’Œè¿™ä¸ªå›¾å­˜åœ¨è½¬æ¢å…³ç³»ï¼Œå…·ä½“ç‚¹å°±æ˜¯ï¼Œæ¨¡å‹çš„1ä¸ªé¡¶ç‚¹å¯¹åº”2å¥—uvå³å¯ï¼Œiosè®¾å¤‡çš„meshæ˜¯åŒ…å«ä¸€ç»„æ‹“æ‰‘uvï¼Œå¦å¤–ä¸€ç»„åˆ™æ˜¯ç…§ç‰‡çš„å±å¹•åæ ‡äº†ï¼Œå‡†ç¡®çš„è®²æ˜¯è§†å£åæ ‡ï¼Œè¿™é‡Œå¯ä»¥æ„é€ ä¸€å¼ lutç”¨æ¥æŸ¥è¯¢ã€‚  
åé¢çš„æ­¥éª¤ä¸­ç¾ç™½æ—¶å€™ï¼Œè¿‡æ»¤ä¸€ä¸‹è¿™ä¸ªMaskå°±å¯ä»¥äº†ã€‚  
å½“ç„¶è¾¹ç¼˜éƒ¨åˆ†åœ¨æ„é€ è¿™ä¸ªå›¾å½¢çš„æ—¶å€™å¯ä»¥ä¿ç•™ä¸€ä¸ªé€šé“ç”¨æ¥èåˆã€‚  
1.æ¢ç³å­”ä¹Ÿæ˜¯è¦ç”¨åˆ°è¿™å¼ å›¾çš„ã€‚ï¼ˆå…¶ä¸­ä¸€ç§æ–¹æ¡ˆï¼‰  
2.ç»™å˜´å”‡ä¸Šè‰²ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ã€‚  
å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹å›¾çš„æ•ˆæœï¼Œè™½ç„¶çš®è‚¤é¢œè‰²æ‹‰çˆ†äº†ï¼Œä½†æ˜¯çœ‰æ¯›å˜´å·´åŸºæœ¬å¾—ä»¥ä¿ç•™ã€‚  
ç”·
![9](/9.png)
å¥³ 
![5](/5.png)

å½“ç„¶æ‹ç…§çš„æ—¶å€™ä¸èƒ½ä¿è¯ç”¨æˆ·æ‹ä¸åˆ°å¤´å‘ï¼Œè¿™ä¸ªAPPä¼šæç¤ºï¼Œæ‰€ä»¥æç¤ºè„åŒºä¹Ÿå¾ˆé‡è¦ï¼Œç®—æ³•æœ‰å…´è¶£çš„å¯ä»¥æ¥å’¨è¯¢ï¼Œæ•ˆæœå¦‚ä¸‹  
![4](/4.png)

å†æ¥æ¬£èµä¸€ä¸‹ 
![2](/2.png)
å…³äºå…‰çº¿çš„éƒ¨åˆ†ä¹Ÿæ˜¯è¦å¥½å¥½è€ƒè™‘çš„ï¼Œè¿™éƒ¨åˆ†å¾ˆéš¾ï¼Œå¯èƒ½æœºå™¨å­¦ä¹ æ˜¯ä¸ªæ€è·¯ã€‚  
å…³äºç³è‰²çš„éƒ¨åˆ†ï¼Œå¯ä»¥è€ƒè™‘ç”¨å‡çœ¼çƒæ¥å®ç°ï¼Œä½†æ˜¯è¦æ³¨æ„å‰è„¸ç¼åˆçœ¼çœ¶å¤„æ˜¯å¦æœ‰æ¼æ´ã€‚ä¹Ÿå¯ä»¥è€ƒè™‘è´´å›¾æ›¿æ¢ï¼Œä½†æ˜¯è¿™ä¸ªå‰è„¸çš„ç…§ç‰‡çš„è´´å›¾ç²¾åº¦åŠ¿å¿…è¦æé«˜ï¼Œè€Œè¿™ä¸ªå°±å’Œiosè®¾å¤‡å‚å•†æ²Ÿé€šäº†ï¼Œå› ä¸ºå›¾ç‰‡æœ¬èº«å°±æ˜¯720pçš„ï¼Œçœ¼ç›éƒ¨åˆ†å æ¯”éå¸¸å°ï¼Œä¸å¤Ÿç²¾ç»†ã€‚  

è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆåœ¨æˆ‘çš„ç½‘ç›˜é‡Œï¼Œå°±ä¸æ–¹ä¾¿å…¬å¼€äº†ï¼ŒåŒ…å«åç»­éª¨éª¼æè„¸çš„éƒ¨åˆ†ï¼Œè¿™ç§æ–¹æ¡ˆåº”è¯¥æ›´å¥½ã€‚åŒ…å«äº†å¤§å¤šæ•°ç°åœ¨MMORPGæ‰‹æ¸¸çš„æè„¸éœ€æ±‚ã€‚

æœ€åç»™å¤§å®¶çœ‹ä¸€ä¸‹æˆå“
![gif](/xy3yg-nnyr0.gif)
<video src="./1614489384025723.mp4" width="800px" height="600px" controls="controls"></video>
çœ‹åˆ°è¿™é‡Œçš„ä¸€å®šæ˜¯çœŸçˆ±äº†ï¼Œè¯·æˆ‘å–æ¯å’–å•¡â˜•ï¸æ€æ ·ï¼Ÿ  
![wechat](/WechatIMG17.jpeg)
![alipay](/WechatIMG16.jpeg)


# uheadgame
## Translated by Google
can u image your head in a unity game?

First of all, I'm showing my ugliness. This is my profile picture which is exactly the same as in my resume. It is not very handsome, with acne marks on my face, and my hair has been out of control for a long time.
![1](/1.png)
But Mihoyo the otaku to save the world, so I became like this one below, ğŸ‘‡ğŸ»
![2](/2.png)
How did it change? There are several steps, it is not convenient to elaborate, I can only talk about a rough version, leave a commemorative, if you want to make a product of your own, welcome to consult, but do not harass, thank you.

The following is the first scheme. This scheme has been applied for a utility patent by the company and can be found.
The first step is to get the face mesh through the ios device. This one has an interface, just check the official Apple documentation.
After obtaining the Mesh, it is naturally stitched. You can see the picture below. The main thing to pay attention to is the point-to-point stitching and adding surface. If you don't understand, you can ask your art friends around you.
At the same time, get the photo at this time and calculate the UV.

![13](/13.png)

The above model can be said to have taken the first step, but it is still very frustrating, isn't it? The acne marks on the face, nothing works, if it's the young lady who took a picture, can't you scare yourself to death? This will definitely not work. Therefore, we have to perform normal whitening and dermabrasion. There are also related articles for reference, such as surface blur, etc. The algorithm should also be optimized, and the surface blur based on O(1) is also required.
You can look at the graphs of 10, 11, and 12  
10
![10](/10.png)
11
![11](/11.png)
12
![12](/12.png)

Okay, after the above two steps, there are still obvious problems. The whitening power is too large, or whitening occurs, that is, the key features of oneself are also whitened off, such as eyebrows, mouth and other facial features. Note that the surface fuzzification is actually a kind of edge-preserving filter. The whitening mentioned here means that the brightening of the color is worth the operation. It can be adjusted by the L value in the HSL, so how to solve the overall problem of over-white or over-black?
The third part is the recognition of the key points of the face. Most of the face recognition plug-ins on the market have 108 recognitions. Below is a particularly happy picture, which is the figure after stitching the key points of the face into a surface. .


![6](/6.png)
That's right, this picture is also my own, isn't it not very similar? correct.  
This diagram and topology are the same as the topology of the mesh uv obtained by the ios device.
In other words, there is a conversion relationship between the photo and this graph. The specific point is that one vertex of the model corresponds to two sets of uv. The mesh of the ios device contains a set of topological uv, and the other set is the screen coordinates of the photo, which is accurate It is the viewport coordinates. Here you can construct a lut for query.
When whitening in the following steps, just filter this Mask.
Of course, the edge part can reserve a channel for fusion when constructing this graphic.
1. This picture is also used to change pupils. (One of the options)
2. It can also be used to color the lips.
You can take a look at the effect in the picture below. Although the skin color is burst, but the eyebrows and mouth are basically preserved.  
male
![9](/9.png)
Female 
![5](/5.png)

Of course, there is no guarantee that the user will not be able to take the hair when taking pictures. This APP will prompt, so the dirty area is also very important. If the algorithm is interested, you can come to consult. The effect is as follows
![4](/4.png)

Let's enjoy it again
![2](/2.png)
The part about light should also be considered carefully. This part is difficult. Perhaps machine learning is an idea.
Regarding the part of the pupil color, you can consider using fake eyeballs to achieve it, but pay attention to whether there are holes in the eye sockets of the front face. You can also consider texture replacement, but the texture accuracy of the front face photo is bound to be improved, and this is communicated with the ios device manufacturer, because the picture itself is 720p, and the proportion of the eyes is very small and not detailed enough.

There is another solution in my network disk, which is not convenient to disclose, including the part of the subsequent bone pinching face. This solution should be better. Contains most of the current MMORPG mobile game's face pinching needs.

Finally, I will show you the finished product
![gif](/xy3yg-nnyr0.gif)

<video src="./1614489384025723.mp4" width="800px" height="600px" controls="controls"></video>
It must be true love to see here. How about a cup of coffee for me?
![wechat](/WechatIMG17.jpeg)
![alipay](/WechatIMG16.jpeg)